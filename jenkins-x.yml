buildPack: ../../jenkins-x-classic/packs/javascript
pipelineConfig:
  pipelines:
    pullRequest:
      build:
        steps:
        - name: npm-test
          sh: |
            ROADIE_TOKEN=\"$(jx step credential -s roadie -k token --optional false)" \
            CI=true \
            DISPLAY=:99 \
            npm test
    release:
      postBuild:
        steps:
          - sh: npm i -g semantic-release
            name: install-semantic-release
          - sh: semantic-release
            name: semantic-release